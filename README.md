
# My Library: Pict3D
My name: Wesley Nuzzo

Pict is a library for creating 3-dimensional scenes.
Unfortunately, the library seems have some problems with it that cause it to run poorly (or give incorrect results) on my computer, but I was able to get interesting and mostly successful results from my experiments with the library in spite of this.

## Cubes

One of the problems with pict3d on my computer is it doesn't seem to render the `sphere` object correctly (although I did find a way around this, see below).
For this reason, when copying the code in the "quick start" section of the pict3d documentation, I changed the sphere to a cube. This displays correctly on my computer.
```
(define (quick-test)
  (list
   (cube origin 1/2)
   (combine (cube origin 1/2) (light (pos 0 1 1)))
   (combine (cube origin 1/2)
            (basis 'camera (point-at (pos 0 0 2) origin)))))
```
This creates three images: an ordinary cube, the same cube with a light source in the scene, and a view of the cube where the camera has been moved to a bird's eye view.

These images can be interacted with in a few different ways. There are buttons at the top which toggle such things as default lighting, indicators that aren't part of the scene and so on. In addition, the camera can be moved around using WASDRF(or the arrow keys combined with pgup and pgdwn) as well as the mouse. (This seems to run slowly when the mouse is hovering over the object, however, presumably because it attempts to calculate and display coordinates in the lower right hand corner.)

Results of running the above with default lighting and indicators on:

![Default Lighting Cubes](Default Lighting Cubes.png)

Results of running the above with default lighting off:

![Scene Lighting Cubes](Scene Lighting Cubes.png)

Pict3d can also generate static bitmap images:
```
(define (bitmap-test)
  (list
   (pict3d->bitmap (cube origin 1/2))
   (pict3d->bitmap
    (combine (cube origin 1/2)
             (light (pos 0 1 1))))))
```
![Unlit Cube](Unlit Cube.png) ![Lit Cube](Lit Cube.png)

Notice that these images are generated with none of the default indicators or lighting from before.

## Spheres
Ordinary spheres generated by pict3d don't seem to be visible on my computer, but I was able to find a way to create them anyway.
For whatever reason, using the `adaptive-deform` transformation on elliptical shapes causes them to display properly for me.
Fortunately, there is an identity transformation, so I can use that to get the original shape.
```
(define (sphere-test)
  (list
   (adaptive-deform (sphere origin 1/2) identity-linear)
   (combine (adaptive-deform (sphere origin 1/2) identity-linear)
            (light (pos 0 1 1)))
   (combine (adaptive-deform (sphere origin 1/2) identity-linear)
            (basis 'camera (point-at (pos 0 0 2) origin)))))
```
The code above is identical to that for the cubes, above, except using spheres.
I simply follow along with the examples from the documentation, using `(adaptive-deform (sphere origin 1/2) identity-linear)` in place of `(sphere origin 1/2)`.

Results (default lighting except for the second one):

![Spheres](Spheres.png)

## Cylinders, Cones, and Pipes
Pict3d supports three different kinds of objects with circle-shaped bases, cylinders, cones, and hollowed-out cylinders (called pipes).
The approach to generating these objects is the same for all three: define a "rectangle" (more accurately a rectangular prism) and generate the shape (with an elliptical base) that most completely fills the space inside it. In addition, each shape has an `#:arc` property that can be modified to change the shape of its base.

The pipe object has a few extra properties: the shape of the top and bottom of the object can be modified by changing their inner and outer radii. These properties are given as fractions of what the radius would be for a cylinder.
```
(define (test-circle-based)
  (list
   ;; displays a cylinder with a pac-man shaped ellipse as its base
   (combine (cylinder origin (dir 1/4 1/2 3/4) #:arc (arc 135 45))
            (with-color (rgba "red" 0.5)
                        (rectangle origin (dir 1/4 1/2 3/4))))
   ;; displays a cone with the same-shaped base
   (combine (cone origin (dir 1/4 1/2 3/4) #:arc (arc 135 45))
            (with-color (rgba "red" 0.5)
                        (rectangle origin (dir 1/4 1/2 3/4))))
   ;; pipe with variable thickness
   ;; notice that the radius > 1 results in the base exceeding the bounds
   ;; of the rectangle
   (combine (pipe origin (dir 1/4 1/2 3/4)
                  #:arc (arc 135 45)
                  #:top-radii (interval 1 1)
                  #:bottom-radii (interval 1/2 3/2))
            (with-color (rgba "red" 0.5)
                        (rectangle origin (dir 1/4 1/2 3/4))))))
```
This generates a cylinder, a cone, and a pipe, each with a base shaped like 3/4 of an ellipse. It also generates a semi-transparent rectangle to indicate the rectangle used to define the shape:

![Circle-Based Shapes](Circle-Based Shapes.png)

## Lighting and Emissive Objects

The documentation provides an example of how to create an object that seems to be lit up from the inside.
This is slightly more difficult than you might expect, because modifying an object's `emitted` property doesn't actually effect the lighting of the surrounding scene.

To demonstrate, here's an object that emits light:
```
(combine (rectangle (pos 0 0 -1) (dir 2 2 1))
                 (deform
                   (with-emitted (emitted "plum" 2)
                                 (tessellate
                                  (scale (cylinder origin 1) (dir 1/8 1/8 1))))
                   (smooth-compose
                    (rotate-z 30)
                    (move-z 1/4)
                    (rotate-x 90)
                    (bend 135 (interval -1 1)))))
```
The object has also rotated and deformed to give it a unique shape. (Note: the shape and color of the object is the same as in the example provided by the documentation.)
The object looks like it's shining brightly, but the surface underneath it isn't lit up:

![Emissive Object](Emissive Object.png)

We can simulate the object being lit up by adding small light sources along its length. This is what the code looks like when we add this, and remove the object's emission characteristic:
```
(combine (rectangle (pos 0 0 -1) (dir 2 2 1))
                 (deform
                   (combine (tessellate
                             (scale (cylinder origin 1) (dir 1/8 1/8 1)))
                            (for/list ([z  (in-range 0 17)])
                              (light (pos 0 0 (- (* 2 (/ z 16)) 1))
                                     (emitted "plum" 1/150))))
                   (smooth-compose
                    (rotate-z 30)
                    (move-z 1/4)
                    (rotate-x 90)
                    (bend 135 (interval -1 1)))))
```
The result is a shape that doesn't appear lit up, but does appear to have an effect on it's environment:

![Object with Lighting](Object with Lighting.png)

We can combine the two effects to make it look as though the shape is lit up properly:
```
(combine (rectangle (pos 0 0 -1) (dir 2 2 1))
                 (deform
                   (combine (with-emitted (emitted "plum" 2)
                                          (tessellate
                                           (scale (cylinder origin 1) (dir 1/8 1/8 1))))
                            (for/list ([z  (in-range 0 17)])
                              (light (pos 0 0 (- (* 2 (/ z 16)) 1))
                                     (emitted "plum" 1/150))))
                   (smooth-compose
                    (rotate-z 30)
                    (move-z 1/4)
                    (rotate-x 90)
                    (bend 135 (interval -1 1)))))
```
![Lit-Up Object](Lit-Up Object.png)

<!-- Links -->
[schedule]: https://github.com/oplS16projects/FP-Schedule
[markdown]: https://help.github.com/articles/markdown-basics/
[forking]: https://guides.github.com/activities/forking/
[ref-clone]: http://gitref.org/creating/#clone
[ref-commit]: http://gitref.org/basic/#commit
[ref-push]: http://gitref.org/remotes/#push
[pull-request]: https://help.github.com/articles/creating-a-pull-request
